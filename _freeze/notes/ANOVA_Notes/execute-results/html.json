{
  "hash": "a3fbfeef38c6e5685361517880fde198",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"ANOVA_Notes\"\nformat: html\neditor: visual\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\n\n\n\n\n#ANOVA (Analysis of variance) with cuckoos data set\n\nAn analysis of variance (ANOVA) is a statistical test used to determine whether a continuous and a categorical variable differ. The categorical variable should have three or more groups, or levels. \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(DAAG)\ndata(\"cuckoos\")\n```\n:::\n\n\n\n\n\nResearch question: Does egg length differ between the six species?\n\nNull hypothesis: \n\n$$\nH_0: \\mu_{\\text{hedgesparrow}} = \\mu_{\\text{meadowpipit}} = \\mu_{\\text{piedwagtail}} = \\mu_{\\text{robin}} = \\mu_{\\text{treepipit}} = \\mu_{\\text{wren}}\n$$\n\nAlternative hypothesis:\n\n$$\nH_a: \\text{At least one mean is different } \\mu_{\\text{species}} \\neq \\mu_{\\text{another species}}\n$$\n\n##Visualizing the data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#box plot\nggplot(data = cuckoos, aes(x = species, y = length))+\n  geom_boxplot()+\n  theme_bw()+\n  theme(axis.text.x = element_text(angle = 60, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](ANOVA_Notes_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n##ANOVA test assumptions\n\n-   Independence: The data collected is from a representative and randomly selected proportion of the total population.\n\n-   Normality: The data should be normally distributed\n\n-   Equality of variances: The variances should be equal across the groups (homoscedasticity).\n\n-  Outliers: There should be no significant outliers in different groups.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = cuckoos,aes(x = length))+\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ANOVA_Notes_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncuckoos %>% \n  group_by(species) %>% \n  summarise(var(length))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  species       `var(length)`\n  <fct>                 <dbl>\n1 hedge.sparrow         1.10 \n2 meadow.pipit          0.846\n3 pied.wagtail          1.15 \n4 robin                 0.465\n5 tree.pipit            0.775\n6 wren                  0.569\n```\n\n\n:::\n:::\n\n\n\n\n\n\n\n\n##Running the anova\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel1 <- aov(length ~ species, data = cuckoos)\nmodel2 <- lm(length ~ species, data = cuckoos)\ntukey <- TukeyHSD(model1)#make sure your object is called \"tukey\" for the code below. \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#Extracting significant pairs\ntukey_df <- as.data.frame(tukey$species)\nnames(tukey_df)[names(tukey_df) == \"p adj\"] <- \"p.adj\"\nsig_pairs <- subset(tukey_df,p.adj < 0.05)\n\n# Create list of comparisons from significant pairs\ncomparisons <- strsplit(row.names(sig_pairs), \"-\")\n#Creating the plot\nlibrary(ggsignif)\nggplot(cuckoos, aes(x = species, y = length)) +\n  geom_boxplot() +\n  geom_signif(comparisons = comparisons,\n  annotations = ifelse(sig_pairs$p.adj < 0.001,   \"***\",                               ifelse(sig_pairs$p.adj < 0.01, \"**\",               ifelse(sig_pairs$p.adj < 0.05, \"*\", \"\"))),\ny_position = seq(25, 35, length.out = nrow(sig_pairs)), #changing location of the bars\ntip_length = 0.02) +\ntheme_bw()+\ntheme(axis.text.x = element_text(angle = 30, \n    hjus = 1, size = 18),\n    axis.text.y = element_text(size = 18),          \n    axis.title.x = element_text(size = 15),         \n    axis.title.y = element_text(size = 20)) +\n  labs(x = \"Host species\", y = \"Egg length (mm)\")\n```\n\n::: {.cell-output-display}\n![](ANOVA_Notes_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n#ANOVA with the penguins data set\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(palmerpenguins)\ndata(\"penguins\")\nView(penguins)\n```\n:::\n\n\n\n\n\nResearch question: does flipper length differ between species?\n\n##Visualizing the data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, aes(x = species, y = flipper_length_mm))+\n  geom_boxplot()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ANOVA_Notes_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n\n\n\n##Checking assumptions\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = penguins, aes(x = flipper_length_mm))+\n  geom_histogram()+\n  facet_wrap(~species)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: Removed 2 rows containing non-finite outside the scale range\n(`stat_bin()`).\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](ANOVA_Notes_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\npenguins %>% \n  group_by(species) %>% \n  summarise(var(flipper_length_mm,  na.rm = TRUE))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 2\n  species   `var(flipper_length_mm, na.rm = TRUE)`\n  <fct>                                      <dbl>\n1 Adelie                                      42.8\n2 Chinstrap                                   50.9\n3 Gentoo                                      42.1\n```\n\n\n:::\n:::\n\n\n\n\n\n##Running the ANOVA\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#using aov\nmod1 <- aov(flipper_length_mm ~ species, data = penguins)\nsummary(mod1)#getting output of the model\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value Pr(>F)    \nspecies       2  52473   26237   594.8 <2e-16 ***\nResiduals   339  14953      44                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n2 observations deleted due to missingness\n```\n\n\n:::\n\n```{.r .cell-code}\ntukey <- TukeyHSD(mod1)\ntukey\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = flipper_length_mm ~ species, data = penguins)\n\n$species\n                      diff       lwr       upr p adj\nChinstrap-Adelie  5.869887  3.586583  8.153191     0\nGentoo-Adelie    27.233349 25.334376 29.132323     0\nGentoo-Chinstrap 21.363462 19.000841 23.726084     0\n```\n\n\n:::\n\n```{.r .cell-code}\n#using lm\nmod2 <- lm(flipper_length_mm ~ species, data = penguins)\nsummary(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = flipper_length_mm ~ species, data = penguins)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17.9536  -4.8235   0.0464   4.8130  20.0464 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      189.9536     0.5405 351.454  < 2e-16 ***\nspeciesChinstrap   5.8699     0.9699   6.052 3.79e-09 ***\nspeciesGentoo     27.2333     0.8067  33.760  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.642 on 339 degrees of freedom\n  (2 observations deleted due to missingness)\nMultiple R-squared:  0.7782,\tAdjusted R-squared:  0.7769 \nF-statistic: 594.8 on 2 and 339 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n",
    "supporting": [
      "ANOVA_Notes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}