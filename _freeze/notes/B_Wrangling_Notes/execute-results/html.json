{
  "hash": "bc5570a362ce7ec311cf91e0f9ffc196",
  "result": {
    "markdown": "---\ntitle: 'Notes B'\nsubtitle: \"Wrangling data with `dplyr`: `filter`, `select`, `arrange`\"\nauthor: \"EMW\" \ndate: \"Tues, June 4, 2024\"\nformat:\n  html:\n    toc: true\n    code-overflow: wrap\n    code-fold: false\n    embed-resources: true\nexecute: \n  message: FALSE\n  warning: FALSE\n---\n\n\n# Importing Data\n\nIn this workshop, we are going to be working with the `possum` dataset which consists of nine morphometric measurements on each of 104 mountain brushtail possums, trapped at seven Australian sites from Southern Victoria to central Queensland. \n\nSource: Lindenmayer, D. B., Viggers, K. L., Cunningham, R. B., and Donnelly, C. F. 1995. Morphological variation among columns of the mountain brushtail possum, Trichosurus caninus Ogilby (Phalangeridae: Marsupiala). Australian Journal of Zoology 43: 449-458.\n\nWhat is a .csv file? \n\nHow do we import it into R?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#possum.csv needs to be saved in the same directory as this file. \n#possum <- read.csv(\"possum.csv\")\n```\n:::\n\n\nAlternatively, you can download it directly from the `DAAD` package. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#You need to install the DAAG package first. Then you can call it using the code below. \nlibrary(DAAG)\ndata(possum)\n```\n:::\n\n\nLet's take a look at this data for a minute to see what information has been recorded. \n\nThis data frame contains the following columns:\n\n- `case`: observation number\n- `site`: one of seven locations where possums were trapped. The sites were, in order,Cambarville, Bellbird, Whian Whian, Byrangery, Conondale, Allyn River and Bulburin\n- `Pop`: a factor which classifies the sites as Vic Victoria, other New South Wales or Queensland\n- `sex`: a factor with levels f female, m male\n- `age`: age\n- `hdlngth`: head length, in cm\n- `skullw`: skull width, in cm\n- `totlngth`: total length, in cm\n- `taill`: tail length, in cm\n- `footlgth`: foot length, in cm\n- `earconch`: ear conch length, in cm\n- `eye`: distance from medial canthus to lateral canthus of right eye, in cm\n- `chest`chest girth, in cm\n- `belly`: belly girth, in cm\n\n# Installing and Using Packages\n\nSometimes everything we need (data, functions, etc) are not available in base R. In R, expert users will package up useful things like data and functions into packages that be download and used. \n\nFirst, you need to download the package from the right hand menu --> \nYou only need to do this once. \n\nIn each new .Rmd document, you need to call any packages you want to use  but adding the code `library(packagename)` inside an R chunk. \n\nFor example, in this class we will use the `tidyverse` package a lot. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\n# `dplyr`\n\nThere are actually many commonly used packages wrapped up inside one `tidyverse` package. \n\nToday we are specifically going to be talking about the package `dplyr` which is useful to manipulating data sets.\n\n# `filter`\n\nWe can use the `filter` function to extract ***rows*** from the data that have a particular characteristic. \n\nFor example, we may be interested in only looking at female possums.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\n#start with the possums dataset, the pipe \"%\" means apply the action on the following line to the previous line. In this case, pick out only the rows were the sex variable is \"f\" \n\n # %>% == and then do this\n\npossum %>%\n  filter(sex == \"f\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      case site   Pop sex age hdlngth skullw totlngth taill footlgth earconch\nC5       2    1   Vic   f   6    92.5   57.6     91.5  36.5     72.5     51.2\nC10      3    1   Vic   f   6    94.0   60.0     95.5  39.0     75.4     51.9\nC15      4    1   Vic   f   6    93.2   57.1     92.0  38.0     76.1     52.2\nC23      5    1   Vic   f   2    91.5   56.3     85.5  36.0     71.0     53.2\nC24      6    1   Vic   f   1    93.1   54.8     90.5  35.5     73.2     53.6\nC27      8    1   Vic   f   6    94.8   57.6     91.0  37.0     72.7     53.9\nC28      9    1   Vic   f   9    93.4   56.3     91.5  37.0     72.4     52.9\nC31     10    1   Vic   f   6    91.8   58.0     89.5  37.5     70.9     53.4\nC32     11    1   Vic   f   9    93.3   57.2     89.5  39.0     77.2     51.3\nC34     12    1   Vic   f   5    94.9   55.6     92.0  35.5     71.7     51.0\nC45     17    1   Vic   f   1    94.7   67.7     89.5  36.5     73.2     53.2\nC48     19    1   Vic   f   5    94.4   55.4     90.5  35.0     73.4     53.9\nC50     20    1   Vic   f   4    94.8   56.3     89.0  38.0     73.8     52.4\nC54     21    1   Vic   f   3    95.9   58.1     96.5  39.5     77.9     52.9\nC58     23    1   Vic   f   4    92.5   56.1     89.0  36.0     72.8     53.3\nC63     27    1   Vic   f   2    90.5   54.5     85.0  35.0     70.3     50.8\nA1      29    1   Vic   f   3    92.8   56.0     88.0  35.0     74.9     51.8\nA2      30    1   Vic   f   2    92.1   54.4     84.0  33.5     70.6     50.8\nA4      32    1   Vic   f   4    94.3   56.7     94.0  39.0     74.8     52.0\nBB17    37    2   Vic   f   2    89.3   54.8     82.5  35.0     71.2     52.0\nBB31    39    2   Vic   f   1    84.7   51.5     75.0  34.0     68.7     53.4\nBB33    40    2   Vic   f   3    91.0   55.0     84.5  36.0     72.8     51.4\nBB36    41    2   Vic   f   5    88.4   57.0     83.0  36.5       NA     40.3\nBB40    43    2   Vic   f   2    90.0   55.5     81.0  32.0     72.0     49.4\nWW4     50    3 other   f   5    91.6   56.4     88.0  38.0     65.0     47.2\nWW5     51    3 other   f   5    95.6   59.6     85.0  36.0     64.0     43.9\nWW7     53    3 other   f   3    93.1   58.1     91.0  38.0     67.4     46.0\nBR4     57    4 other   f   4    95.1   59.4     93.0  41.0     67.2     45.3\nBR7     60    4 other   f   2    91.3   57.7     88.0  39.0     63.1     47.0\nCD2     62    5 other   f   3    91.3   58.0     90.5  39.0     65.5     41.3\nCD3     63    5 other   f   6    92.0   56.4     88.5  38.0     64.1     46.3\nCD4     64    5 other   f   3    96.9   56.5     89.5  38.5     63.0     45.1\nCD5     65    5 other   f   5    93.5   57.4     88.5  38.0     68.2     41.7\nCD6     66    5 other   f   3    90.4   55.8     86.0  36.5     63.2     44.2\nCD10    70    5 other   f   7    91.9   56.4     87.0  38.0     65.4     44.1\nBSF1    74    6 other   f   4    88.7   52.0     83.0  38.0     61.5     45.9\nBSF9    82    6 other   f   4    86.0   54.0     82.0  36.5     60.7     42.9\nBSF10   83    6 other   f   3    90.0   53.8     81.5  36.0     62.0     43.3\nBSF13   86    6 other   f   3    88.2   53.2     86.5  38.5     60.3     43.7\nBTP3    88    7 other   f   2    89.6   58.0     87.5  38.0     66.7     43.5\nBTP15   99    7 other   f   3    93.3   56.2     86.5  38.5     64.8     43.8\nBTP19  102    7 other   f   6    92.4   55.0     89.0  38.0     63.5     45.4\nBTP21  104    7 other   f   3    93.6   59.9     89.0  40.0     67.6     46.0\n       eye chest belly\nC5    16.0  28.5  33.0\nC10   15.5  30.0  34.0\nC15   15.2  28.0  34.0\nC23   15.1  28.5  33.0\nC24   14.2  30.0  32.0\nC27   14.5  29.0  34.0\nC28   15.5  28.0  33.0\nC31   14.4  27.5  32.0\nC32   14.9  31.0  34.0\nC34   15.3  28.0  33.0\nC45   14.7  29.0  31.0\nC48   15.2  28.0  32.0\nC50   15.5  27.0  36.0\nC54   14.2  30.0  40.0\nC58   15.4  28.0  35.0\nC63   14.2  23.0  28.0\nA1    14.0  24.0  32.0\nA2    14.5  24.5  33.0\nA4    14.9  28.0  34.0\nBB17  13.6  28.0  31.5\nBB31  13.0  25.0  25.0\nBB33  13.6  27.0  30.0\nBB36  15.9  27.0  30.5\nBB40  13.4  29.0  31.0\nWW4   14.9  28.0  36.0\nWW5   17.4  28.0  38.5\nWW7   16.5  26.0  33.5\nBR4   14.5  31.0  39.0\nBR7   14.4  26.0  30.0\nCD2   16.0  27.0  32.0\nCD3   15.2  25.5  28.5\nCD4   17.1  25.5  33.0\nCD5   14.0  29.0  38.5\nCD6   15.7  26.5  34.0\nCD10  13.0  27.0  34.0\nBSF1  14.7  26.0  34.0\nBSF9  15.4  26.0  32.0\nBSF10 14.0  25.0  29.0\nBSF13 13.6  26.0  31.0\nBTP3  16.0  25.5  31.5\nBTP15 14.0  28.0  35.0\nBTP19 13.0  25.0  30.0\nBTP21 14.8  28.5  33.5\n```\n:::\n\n```{.r .cell-code}\n##note the sex is text/categorical and so quotation marks are needed. \n##R doesn't care about whether they are double quotation marks (\") or single ('). They work the same. \n# If we don't assign it to an object, then it just prints out for us to see! \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#oftentimes, we want to take our subset and give it a new name. This takes our subset and assigns it to a new dataset called `possum_f`. \n\npossum_f <- possum %>%\n  filter(sex == \"f\")\n\n#Notice if you assign it to an object that it doesn't print out the contents. \n# You'll see the new object in your environment on the top right ---> \n# If you click on the word `possum_f` (not the blue play button) it will open the object so you can see what is saved inside. \n```\n:::\n\n\nIt can also be used with numeric criteria. \n\nSuppose we want a list of all the possums whose total length is less than 80cm. \n\n\n::: {.cell}\n\n```{.r .cell-code}\npossum %>% \n  filter(totlngth < 80)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     case site Pop sex age hdlngth skullw totlngth taill footlgth earconch  eye\nBB31   39    2 Vic   f   1    84.7   51.5       75  34.0     68.7     53.4 13.0\nBB38   42    2 Vic   m   3    85.3   54.1       77  32.0     62.7     51.2 13.8\nBB41   44    2 Vic   m  NA    85.1   51.5       76  35.5     70.3     52.6 14.4\n     chest belly\nBB31  25.0    25\nBB38  25.5    33\nBB41  23.0    27\n```\n:::\n:::\n\n\nThe logical operators are given below: \n\n![](https://ehsanx.github.io/intro2R/images/logical.png){width=50%}\n\n# `select`\n\nselect is used to extract only certain ***columns***. For example, perhaps we only want to print out a dataset with only the population, the sex, and the total length of each possum. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# %>% \n#MAC (CMD + Shift + M)\n#PC (Ctrl + Shift + M)\n\npossum %>% \n  select(Pop, sex, totlngth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        Pop sex totlngth\nC3      Vic   m     89.0\nC5      Vic   f     91.5\nC10     Vic   f     95.5\nC15     Vic   f     92.0\nC23     Vic   f     85.5\nC24     Vic   f     90.5\nC26     Vic   m     89.5\nC27     Vic   f     91.0\nC28     Vic   f     91.5\nC31     Vic   f     89.5\nC32     Vic   f     89.5\nC34     Vic   f     92.0\nC36     Vic   m     89.5\nC37     Vic   m     91.5\nC39     Vic   m     85.5\nC40     Vic   m     86.0\nC45     Vic   f     89.5\nC47     Vic   m     90.0\nC48     Vic   f     90.5\nC50     Vic   f     89.0\nC54     Vic   f     96.5\nC55     Vic   m     91.0\nC58     Vic   f     89.0\nC59     Vic   m     84.0\nC60     Vic   m     91.5\nC61     Vic   m     90.0\nC63     Vic   f     85.0\nC64     Vic   m     87.0\nA1      Vic   f     88.0\nA2      Vic   f     84.0\nA3      Vic   m     93.0\nA4      Vic   f     94.0\nAD1     Vic   m     89.0\nBB4     Vic   m     85.5\nBB13    Vic   m     85.0\nBB15    Vic   m     88.0\nBB17    Vic   f     82.5\nBB25    Vic   m     80.5\nBB31    Vic   f     75.0\nBB33    Vic   f     84.5\nBB36    Vic   f     83.0\nBB38    Vic   m     77.0\nBB40    Vic   f     81.0\nBB41    Vic   m     76.0\nBB44    Vic   m     81.0\nBB45    Vic   m     84.0\nWW1   other   m     89.0\nWW2   other   m     85.0\nWW3   other   m     85.0\nWW4   other   f     88.0\nWW5   other   f     85.0\nWW6   other   m     93.5\nWW7   other   f     91.0\nBR1   other   m     91.5\nBR2   other   m     92.5\nBR3   other   m     93.7\nBR4   other   f     93.0\nBR5   other   m     91.0\nBR6   other   m     96.0\nBR7   other   f     88.0\nCD1   other   m     86.0\nCD2   other   f     90.5\nCD3   other   f     88.5\nCD4   other   f     89.5\nCD5   other   f     88.5\nCD6   other   f     86.0\nCD7   other   m     85.0\nCD8   other   m     88.5\nCD9   other   m     88.0\nCD10  other   f     87.0\nCD11  other   m     90.0\nCD12  other   m     80.5\nCD13  other   m     82.0\nBSF1  other   f     83.0\nBSF2  other   m     89.0\nBSF3  other   m     89.0\nBSF4  other   m     84.0\nBSF5  other   m     81.0\nBSF6  other   m     81.0\nBSF7  other   m     84.0\nBSF8  other   m     85.5\nBSF9  other   f     82.0\nBSF10 other   f     81.5\nBSF11 other   m     80.5\nBSF12 other   m     92.0\nBSF13 other   f     86.5\nBTP1  other   m     93.0\nBTP3  other   f     87.5\nBTP4  other   m     84.5\nBTP5  other   m     85.0\nBTP6  other   m     89.0\nBTP7  other   m     85.0\nBTP8  other   m     82.0\nBTP9  other   m     84.0\nBTP10 other   m     88.5\nBTP12 other   m     83.0\nBTP13 other   m     86.0\nBTP14 other   m     84.0\nBTP15 other   f     86.5\nBTP16 other   m     81.5\nBTP17 other   m     82.5\nBTP19 other   f     89.0\nBTP20 other   m     82.5\nBTP21 other   f     89.0\n```\n:::\n:::\n\n\nWe can combine criteria together as well in one command with multiple pipes: \n\n\n::: {.cell}\n\n```{.r .cell-code}\npossum %>% \n  filter(sex == \"f\") %>% \n  filter(totlngth < 80) %>% \n  select(Pop, sex, age, totlngth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     Pop sex age totlngth\nBB31 Vic   f   1       75\n```\n:::\n:::\n\n\n# `arrange`\n\nThe `arrange` function allows us to order the rows of the data frame by the values of a particular column. \n\nFor example, arrange all the female possums by the longest length to the shortest total length\n\n\n::: {.cell}\n\n```{.r .cell-code}\npossum_f %>% \n  arrange(-totlngth)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      case site   Pop sex age hdlngth skullw totlngth taill footlgth earconch\nC54     21    1   Vic   f   3    95.9   58.1     96.5  39.5     77.9     52.9\nC10      3    1   Vic   f   6    94.0   60.0     95.5  39.0     75.4     51.9\nA4      32    1   Vic   f   4    94.3   56.7     94.0  39.0     74.8     52.0\nBR4     57    4 other   f   4    95.1   59.4     93.0  41.0     67.2     45.3\nC15      4    1   Vic   f   6    93.2   57.1     92.0  38.0     76.1     52.2\nC34     12    1   Vic   f   5    94.9   55.6     92.0  35.5     71.7     51.0\nC5       2    1   Vic   f   6    92.5   57.6     91.5  36.5     72.5     51.2\nC28      9    1   Vic   f   9    93.4   56.3     91.5  37.0     72.4     52.9\nC27      8    1   Vic   f   6    94.8   57.6     91.0  37.0     72.7     53.9\nWW7     53    3 other   f   3    93.1   58.1     91.0  38.0     67.4     46.0\nC24      6    1   Vic   f   1    93.1   54.8     90.5  35.5     73.2     53.6\nC48     19    1   Vic   f   5    94.4   55.4     90.5  35.0     73.4     53.9\nCD2     62    5 other   f   3    91.3   58.0     90.5  39.0     65.5     41.3\nC31     10    1   Vic   f   6    91.8   58.0     89.5  37.5     70.9     53.4\nC32     11    1   Vic   f   9    93.3   57.2     89.5  39.0     77.2     51.3\nC45     17    1   Vic   f   1    94.7   67.7     89.5  36.5     73.2     53.2\nCD4     64    5 other   f   3    96.9   56.5     89.5  38.5     63.0     45.1\nC50     20    1   Vic   f   4    94.8   56.3     89.0  38.0     73.8     52.4\nC58     23    1   Vic   f   4    92.5   56.1     89.0  36.0     72.8     53.3\nBTP19  102    7 other   f   6    92.4   55.0     89.0  38.0     63.5     45.4\nBTP21  104    7 other   f   3    93.6   59.9     89.0  40.0     67.6     46.0\nCD3     63    5 other   f   6    92.0   56.4     88.5  38.0     64.1     46.3\nCD5     65    5 other   f   5    93.5   57.4     88.5  38.0     68.2     41.7\nA1      29    1   Vic   f   3    92.8   56.0     88.0  35.0     74.9     51.8\nWW4     50    3 other   f   5    91.6   56.4     88.0  38.0     65.0     47.2\nBR7     60    4 other   f   2    91.3   57.7     88.0  39.0     63.1     47.0\nBTP3    88    7 other   f   2    89.6   58.0     87.5  38.0     66.7     43.5\nCD10    70    5 other   f   7    91.9   56.4     87.0  38.0     65.4     44.1\nBSF13   86    6 other   f   3    88.2   53.2     86.5  38.5     60.3     43.7\nBTP15   99    7 other   f   3    93.3   56.2     86.5  38.5     64.8     43.8\nCD6     66    5 other   f   3    90.4   55.8     86.0  36.5     63.2     44.2\nC23      5    1   Vic   f   2    91.5   56.3     85.5  36.0     71.0     53.2\nC63     27    1   Vic   f   2    90.5   54.5     85.0  35.0     70.3     50.8\nWW5     51    3 other   f   5    95.6   59.6     85.0  36.0     64.0     43.9\nBB33    40    2   Vic   f   3    91.0   55.0     84.5  36.0     72.8     51.4\nA2      30    1   Vic   f   2    92.1   54.4     84.0  33.5     70.6     50.8\nBB36    41    2   Vic   f   5    88.4   57.0     83.0  36.5       NA     40.3\nBSF1    74    6 other   f   4    88.7   52.0     83.0  38.0     61.5     45.9\nBB17    37    2   Vic   f   2    89.3   54.8     82.5  35.0     71.2     52.0\nBSF9    82    6 other   f   4    86.0   54.0     82.0  36.5     60.7     42.9\nBSF10   83    6 other   f   3    90.0   53.8     81.5  36.0     62.0     43.3\nBB40    43    2   Vic   f   2    90.0   55.5     81.0  32.0     72.0     49.4\nBB31    39    2   Vic   f   1    84.7   51.5     75.0  34.0     68.7     53.4\n       eye chest belly\nC54   14.2  30.0  40.0\nC10   15.5  30.0  34.0\nA4    14.9  28.0  34.0\nBR4   14.5  31.0  39.0\nC15   15.2  28.0  34.0\nC34   15.3  28.0  33.0\nC5    16.0  28.5  33.0\nC28   15.5  28.0  33.0\nC27   14.5  29.0  34.0\nWW7   16.5  26.0  33.5\nC24   14.2  30.0  32.0\nC48   15.2  28.0  32.0\nCD2   16.0  27.0  32.0\nC31   14.4  27.5  32.0\nC32   14.9  31.0  34.0\nC45   14.7  29.0  31.0\nCD4   17.1  25.5  33.0\nC50   15.5  27.0  36.0\nC58   15.4  28.0  35.0\nBTP19 13.0  25.0  30.0\nBTP21 14.8  28.5  33.5\nCD3   15.2  25.5  28.5\nCD5   14.0  29.0  38.5\nA1    14.0  24.0  32.0\nWW4   14.9  28.0  36.0\nBR7   14.4  26.0  30.0\nBTP3  16.0  25.5  31.5\nCD10  13.0  27.0  34.0\nBSF13 13.6  26.0  31.0\nBTP15 14.0  28.0  35.0\nCD6   15.7  26.5  34.0\nC23   15.1  28.5  33.0\nC63   14.2  23.0  28.0\nWW5   17.4  28.0  38.5\nBB33  13.6  27.0  30.0\nA2    14.5  24.5  33.0\nBB36  15.9  27.0  30.5\nBSF1  14.7  26.0  34.0\nBB17  13.6  28.0  31.5\nBSF9  15.4  26.0  32.0\nBSF10 14.0  25.0  29.0\nBB40  13.4  29.0  31.0\nBB31  13.0  25.0  25.0\n```\n:::\n\n```{.r .cell-code}\n#use arrange(variable) to go from least to most\n#use arrange(desc(variable)) to go from most to least, arrange(-variable) also works\n```\n:::\n\n\n# `slice`\n\nThe slice function will allow us to pick only a subset of the rows based on their numeric order (1st through last). \n\nFor example, if I want a list the 5 female possums with longest total lengths.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\npossum_f %>% \n  arrange(-totlngth) %>% \n  slice(1:5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    case site   Pop sex age hdlngth skullw totlngth taill footlgth earconch\nC54   21    1   Vic   f   3    95.9   58.1     96.5  39.5     77.9     52.9\nC10    3    1   Vic   f   6    94.0   60.0     95.5  39.0     75.4     51.9\nA4    32    1   Vic   f   4    94.3   56.7     94.0  39.0     74.8     52.0\nBR4   57    4 other   f   4    95.1   59.4     93.0  41.0     67.2     45.3\nC15    4    1   Vic   f   6    93.2   57.1     92.0  38.0     76.1     52.2\n     eye chest belly\nC54 14.2    30    40\nC10 15.5    30    34\nA4  14.9    28    34\nBR4 14.5    31    39\nC15 15.2    28    34\n```\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}